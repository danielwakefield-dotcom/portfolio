(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{259:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));n(72);var r=n(31),o=n(16),c=n(17),l=n(41),d=n(40),h=n(22),f=(n(14),n(30),n(341),n(343),n(34),n(24),n(103),n(136),n(196),n(307),n(44),n(269),n(302),n(274),n(275),n(276),n(277),n(278),n(279),n(280),n(281),n(282),n(283),n(284),n(285),n(286),n(287),n(289),n(290),n(291),n(292),n(293),n(294),n(299),n(300),n(301),n(50),n(305),n(306),n(303),n(344),n(272),n(304),n(0));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var o=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var v=new WeakMap,y=function(e){Object(l.a)(n,e);var t=m(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).decoderPath="",r.decoderConfig={},r.decoderBinary=null,r.decoderPending=null,r.workerLimit=4,r.workerPool=[],r.workerNextTaskID=1,r.workerSourceURL="",r.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},r.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"},r}return Object(c.a)(n,[{key:"setDecoderPath",value:function(path){return this.decoderPath=path,this}},{key:"setDecoderConfig",value:function(e){return this.decoderConfig=e,this}},{key:"setWorkerLimit",value:function(e){return this.workerLimit=e,this}},{key:"load",value:function(e,t,n,r){var o=this,c=new f.o(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,(function(e){var n={attributeIDs:o.defaultAttributeIDs,attributeTypes:o.defaultAttributeTypes,useUniqueIDs:!1};o.decodeGeometry(e,n).then(t).catch(r)}),n,r)}},{key:"decodeDracoFile",value:function(e,t,n,r){var o={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(e,o).then(t)}},{key:"decodeGeometry",value:function(e,t){var n=this;for(var r in t.attributeTypes){var o=t.attributeTypes[r];void 0!==o.BYTES_PER_ELEMENT&&(t.attributeTypes[r]=o.name)}var c,l=JSON.stringify(t);if(v.has(e)){var d=v.get(e);if(d.key===l)return d.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}var h=this.workerNextTaskID++,f=e.byteLength,m=this._getWorker(h,f).then((function(n){return c=n,new Promise((function(n,r){c._callbacks[h]={resolve:n,reject:r},c.postMessage({type:"decode",id:h,taskConfig:t,buffer:e},[e])}))})).then((function(e){return n._createGeometry(e.geometry)}));return m.catch((function(){return!0})).then((function(){c&&h&&n._releaseTask(c,h)})),v.set(e,{key:l,promise:m}),m}},{key:"_createGeometry",value:function(e){var t=new f.g;e.index&&t.setIndex(new f.f(e.index.array,1));for(var i=0;i<e.attributes.length;i++){var n=e.attributes[i],r=n.name,o=n.array,c=n.itemSize;t.setAttribute(r,new f.f(o,c))}return t}},{key:"_loadLibrary",value:function(e,t){var n=new f.o(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise((function(t,r){n.load(e,t,void 0,r)}))}},{key:"preload",value:function(){return this._initDecoder(),this}},{key:"_initDecoder",value:function(){var e=this;if(this.decoderPending)return this.decoderPending;var t="object"!==("undefined"==typeof WebAssembly?"undefined":Object(r.a)(WebAssembly))||"js"===this.decoderConfig.type,n=[];return t?n.push(this._loadLibrary("draco_decoder.js","text")):(n.push(this._loadLibrary("draco_wasm_wrapper.js","text")),n.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(n).then((function(n){var r=n[0];t||(e.decoderConfig.wasmBinary=n[1]);var o=T.toString(),body=["/* draco decoder */",r,"","/* worker */",o.substring(o.indexOf("{")+1,o.lastIndexOf("}"))].join("\n");e.workerSourceURL=URL.createObjectURL(new Blob([body]))})),this.decoderPending}},{key:"_getWorker",value:function(e,t){var n=this;return this._initDecoder().then((function(){if(n.workerPool.length<n.workerLimit){var r=new Worker(n.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:n.decoderConfig}),r.onmessage=function(e){var t=e.data;switch(t.type){case"decode":r._callbacks[t.id].resolve(t);break;case"error":r._callbacks[t.id].reject(t);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+t.type+'"')}},n.workerPool.push(r)}else n.workerPool.sort((function(a,b){return a._taskLoad>b._taskLoad?-1:1}));var o=n.workerPool[n.workerPool.length-1];return o._taskCosts[e]=t,o._taskLoad+=t,o}))}},{key:"_releaseTask",value:function(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}},{key:"debug",value:function(){console.log("Task load: ",this.workerPool.map((function(e){return e._taskLoad})))}},{key:"dispose",value:function(){for(var i=0;i<this.workerPool.length;++i)this.workerPool[i].terminate();return this.workerPool.length=0,this}}]),n}(f.H);function T(){var e,t;function n(e,t,n,r,o,c){var l=c.num_components(),d=n.num_points()*l,h=d*o.BYTES_PER_ELEMENT,f=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,o),m=e._malloc(h);t.GetAttributeDataArrayForAllPoints(n,c,f,h,m);var v=new o(e.HEAPF32.buffer,m,d).slice();return e._free(m),{name:r,array:v,itemSize:l}}onmessage=function(r){var o=r.data;switch(o.type){case"init":e=o.decoderConfig,t=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":var c=o.buffer,l=o.taskConfig;t.then((function(e){var t=e.draco,r=new t.Decoder,d=new t.DecoderBuffer;d.Init(new Int8Array(c),c.byteLength);try{var h=function(e,t,r,o){var c,l,d=o.attributeIDs,h=o.attributeTypes,f=t.GetEncodedGeometryType(r);if(f===e.TRIANGULAR_MESH)c=new e.Mesh,l=t.DecodeBufferToMesh(r,c);else{if(f!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");c=new e.PointCloud,l=t.DecodeBufferToPointCloud(r,c)}if(!l.ok()||0===c.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+l.error_msg());var m={index:null,attributes:[]};for(var v in d){var y=self[h[v]],T=void 0,E=void 0;if(o.useUniqueIDs)E=d[v],T=t.GetAttributeByUniqueId(c,E);else{if(-1===(E=t.GetAttributeId(c,e[d[v]])))continue;T=t.GetAttribute(c,E)}m.attributes.push(n(e,t,c,v,y,T))}f===e.TRIANGULAR_MESH&&(m.index=function(e,t,n){var r=3*n.num_faces(),o=4*r,c=e._malloc(o);t.GetTrianglesUInt32Array(n,o,c);var l=new Uint32Array(e.HEAPF32.buffer,c,r).slice();return e._free(c),{array:l,itemSize:1}}(e,t,c));return e.destroy(c),m}(t,r,d,l),f=h.attributes.map((function(e){return e.array.buffer}));h.index&&f.push(h.index.array.buffer),self.postMessage({type:"decode",id:o.id,geometry:h},f)}catch(e){console.error(e),self.postMessage({type:"error",id:o.id,error:e.message})}finally{t.destroy(d),t.destroy(r)}}))}}}},260:function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));n(72);var r=n(16),o=n(140),c=n(41),l=n(40),d=n(22),h=(n(14),n(34),n(345),n(0));function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(d.a)(e);if(t){var o=Object(d.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var m={type:"change"},v={type:"start"},y={type:"end"},T=function(e){Object(c.a)(n,e);var t=f(n);function n(object,e){var c,l,d,f,T,E,w;Object(r.a)(this,n),c=t.call(this),void 0===e&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),c.object=object,c.domElement=e,c.enabled=!0,c.target=new h.wb,c.minDistance=0,c.maxDistance=1/0,c.minZoom=0,c.maxZoom=1/0,c.minPolarAngle=0,c.maxPolarAngle=Math.PI,c.minAzimuthAngle=-1/0,c.maxAzimuthAngle=1/0,c.enableDamping=!1,c.dampingFactor=.05,c.enableZoom=!0,c.zoomSpeed=1,c.enableRotate=!0,c.rotateSpeed=1,c.enablePan=!0,c.panSpeed=1,c.screenSpacePanning=!0,c.keyPanSpeed=7,c.autoRotate=!1,c.autoRotateSpeed=2,c.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},c.mouseButtons={LEFT:h.J.ROTATE,MIDDLE:h.J.DOLLY,RIGHT:h.J.PAN},c.touches={ONE:h.pb.ROTATE,TWO:h.pb.DOLLY_PAN},c.target0=c.target.clone(),c.position0=c.object.position.clone(),c.zoom0=c.object.zoom,c._domElementKeyEvents=null,c.getPolarAngle=function(){return O.phi},c.getAzimuthalAngle=function(){return O.theta},c.listenToKeyEvents=function(e){e.addEventListener("keydown",ce),this._domElementKeyEvents=e},c.saveState=function(){R.target0.copy(R.target),R.position0.copy(R.object.position),R.zoom0=R.object.zoom},c.reset=function(){R.target.copy(R.target0),R.object.position.copy(R.position0),R.object.zoom=R.zoom0,R.object.updateProjectionMatrix(),R.dispatchEvent(m),R.update(),A=x.NONE},c.update=(l=new h.wb,d=(new h.db).setFromUnitVectors(object.up,new h.wb(0,1,0)),f=d.clone().invert(),T=new h.wb,E=new h.db,w=2*Math.PI,function(){var e=R.object.position;l.copy(e).sub(R.target),l.applyQuaternion(d),O.setFromVector3(l),R.autoRotate&&A===x.NONE&&B(2*Math.PI/60/60*R.autoRotateSpeed),R.enableDamping?(O.theta+=M.theta*R.dampingFactor,O.phi+=M.phi*R.dampingFactor):(O.theta+=M.theta,O.phi+=M.phi);var t=R.minAzimuthAngle,n=R.maxAzimuthAngle;return isFinite(t)&&isFinite(n)&&(t<-Math.PI?t+=w:t>Math.PI&&(t-=w),n<-Math.PI?n+=w:n>Math.PI&&(n-=w),O.theta=t<=n?Math.max(t,Math.min(n,O.theta)):O.theta>(t+n)/2?Math.max(t,O.theta):Math.min(n,O.theta)),O.phi=Math.max(R.minPolarAngle,Math.min(R.maxPolarAngle,O.phi)),O.makeSafe(),O.radius*=L,O.radius=Math.max(R.minDistance,Math.min(R.maxDistance,O.radius)),!0===R.enableDamping?R.target.addScaledVector(k,R.dampingFactor):R.target.add(k),l.setFromSpherical(O),l.applyQuaternion(f),e.copy(R.target).add(l),R.object.lookAt(R.target),!0===R.enableDamping?(M.theta*=1-R.dampingFactor,M.phi*=1-R.dampingFactor,k.multiplyScalar(1-R.dampingFactor)):(M.set(0,0,0),k.set(0,0,0)),L=1,!!(S||T.distanceToSquared(R.object.position)>_||8*(1-E.dot(R.object.quaternion))>_)&&(R.dispatchEvent(m),T.copy(R.object.position),E.copy(R.object.quaternion),S=!1,!0)}),c.dispose=function(){R.domElement.removeEventListener("contextmenu",pe),R.domElement.removeEventListener("pointerdown",se),R.domElement.removeEventListener("wheel",ue),R.domElement.removeEventListener("touchstart",le),R.domElement.removeEventListener("touchend",he),R.domElement.removeEventListener("touchmove",de),R.domElement.ownerDocument.removeEventListener("pointermove",oe),R.domElement.ownerDocument.removeEventListener("pointerup",ie),null!==R._domElementKeyEvents&&R._domElementKeyEvents.removeEventListener("keydown",ce)};var R=Object(o.a)(c),x={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},A=x.NONE,_=1e-6,O=new h.nb,M=new h.nb,L=1,k=new h.wb,S=!1,P=new h.vb,I=new h.vb,N=new h.vb,j=new h.vb,C=new h.vb,D=new h.vb,U=new h.vb,H=new h.vb,F=new h.vb;function G(){return Math.pow(.95,R.zoomSpeed)}function B(e){M.theta-=e}function K(e){M.phi-=e}var X,V=(X=new h.wb,function(e,t){X.setFromMatrixColumn(t,0),X.multiplyScalar(-e),k.add(X)}),Y=function(){var e=new h.wb;return function(t,n){!0===R.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(R.object.up,e)),e.multiplyScalar(t),k.add(e)}}(),z=function(){var e=new h.wb;return function(t,n){var element=R.domElement;if(R.object.isPerspectiveCamera){var r=R.object.position;e.copy(r).sub(R.target);var o=e.length();o*=Math.tan(R.object.fov/2*Math.PI/180),V(2*t*o/element.clientHeight,R.object.matrix),Y(2*n*o/element.clientHeight,R.object.matrix)}else R.object.isOrthographicCamera?(V(t*(R.object.right-R.object.left)/R.object.zoom/element.clientWidth,R.object.matrix),Y(n*(R.object.top-R.object.bottom)/R.object.zoom/element.clientHeight,R.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),R.enablePan=!1)}}();function W(e){R.object.isPerspectiveCamera?L/=e:R.object.isOrthographicCamera?(R.object.zoom=Math.max(R.minZoom,Math.min(R.maxZoom,R.object.zoom*e)),R.object.updateProjectionMatrix(),S=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),R.enableZoom=!1)}function Z(e){R.object.isPerspectiveCamera?L*=e:R.object.isOrthographicCamera?(R.object.zoom=Math.max(R.minZoom,Math.min(R.maxZoom,R.object.zoom/e)),R.object.updateProjectionMatrix(),S=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),R.enableZoom=!1)}function J(e){P.set(e.clientX,e.clientY)}function Q(e){j.set(e.clientX,e.clientY)}function $(e){if(1==e.touches.length)P.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);P.set(t,n)}}function ee(e){if(1==e.touches.length)j.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);j.set(t,n)}}function te(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+n*n);U.set(0,r)}function ne(e){if(1==e.touches.length)I.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);I.set(t,n)}N.subVectors(I,P).multiplyScalar(R.rotateSpeed);var element=R.domElement;B(2*Math.PI*N.x/element.clientHeight),K(2*Math.PI*N.y/element.clientHeight),P.copy(I)}function re(e){if(1==e.touches.length)C.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);C.set(t,n)}D.subVectors(C,j).multiplyScalar(R.panSpeed),z(D.x,D.y),j.copy(C)}function ae(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+n*n);H.set(0,r),F.set(0,Math.pow(H.y/U.y,R.zoomSpeed)),W(F.y),U.copy(H)}function se(e){if(!1!==R.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){var t;switch(e.preventDefault(),R.domElement.focus?R.domElement.focus():window.focus(),e.button){case 0:t=R.mouseButtons.LEFT;break;case 1:t=R.mouseButtons.MIDDLE;break;case 2:t=R.mouseButtons.RIGHT;break;default:t=-1}switch(t){case h.J.DOLLY:if(!1===R.enableZoom)return;!function(e){U.set(e.clientX,e.clientY)}(e),A=x.DOLLY;break;case h.J.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===R.enablePan)return;Q(e),A=x.PAN}else{if(!1===R.enableRotate)return;J(e),A=x.ROTATE}break;case h.J.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===R.enableRotate)return;J(e),A=x.ROTATE}else{if(!1===R.enablePan)return;Q(e),A=x.PAN}break;default:A=x.NONE}A!==x.NONE&&(R.domElement.ownerDocument.addEventListener("pointermove",oe),R.domElement.ownerDocument.addEventListener("pointerup",ie),R.dispatchEvent(v))}(e)}}function oe(e){if(!1!==R.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){if(!1===R.enabled)return;switch(e.preventDefault(),A){case x.ROTATE:if(!1===R.enableRotate)return;!function(e){I.set(e.clientX,e.clientY),N.subVectors(I,P).multiplyScalar(R.rotateSpeed);var element=R.domElement;B(2*Math.PI*N.x/element.clientHeight),K(2*Math.PI*N.y/element.clientHeight),P.copy(I),R.update()}(e);break;case x.DOLLY:if(!1===R.enableZoom)return;!function(e){H.set(e.clientX,e.clientY),F.subVectors(H,U),F.y>0?W(G()):F.y<0&&Z(G()),U.copy(H),R.update()}(e);break;case x.PAN:if(!1===R.enablePan)return;!function(e){C.set(e.clientX,e.clientY),D.subVectors(C,j).multiplyScalar(R.panSpeed),z(D.x,D.y),j.copy(C),R.update()}(e)}}(e)}}function ie(e){switch(e.pointerType){case"mouse":case"pen":!function(e){if(R.domElement.ownerDocument.removeEventListener("pointermove",oe),R.domElement.ownerDocument.removeEventListener("pointerup",ie),!1===R.enabled)return;R.dispatchEvent(y),A=x.NONE}()}}function ue(e){!1===R.enabled||!1===R.enableZoom||A!==x.NONE&&A!==x.ROTATE||(e.preventDefault(),R.dispatchEvent(v),function(e){e.deltaY<0?Z(G()):e.deltaY>0&&W(G()),R.update()}(e),R.dispatchEvent(y))}function ce(e){!1!==R.enabled&&!1!==R.enablePan&&function(e){var t=!1;switch(e.code){case R.keys.UP:z(0,R.keyPanSpeed),t=!0;break;case R.keys.BOTTOM:z(0,-R.keyPanSpeed),t=!0;break;case R.keys.LEFT:z(R.keyPanSpeed,0),t=!0;break;case R.keys.RIGHT:z(-R.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),R.update())}(e)}function le(e){if(!1!==R.enabled){switch(e.preventDefault(),e.touches.length){case 1:switch(R.touches.ONE){case h.pb.ROTATE:if(!1===R.enableRotate)return;$(e),A=x.TOUCH_ROTATE;break;case h.pb.PAN:if(!1===R.enablePan)return;ee(e),A=x.TOUCH_PAN;break;default:A=x.NONE}break;case 2:switch(R.touches.TWO){case h.pb.DOLLY_PAN:if(!1===R.enableZoom&&!1===R.enablePan)return;!function(e){R.enableZoom&&te(e),R.enablePan&&ee(e)}(e),A=x.TOUCH_DOLLY_PAN;break;case h.pb.DOLLY_ROTATE:if(!1===R.enableZoom&&!1===R.enableRotate)return;!function(e){R.enableZoom&&te(e),R.enableRotate&&$(e)}(e),A=x.TOUCH_DOLLY_ROTATE;break;default:A=x.NONE}break;default:A=x.NONE}A!==x.NONE&&R.dispatchEvent(v)}}function de(e){if(!1!==R.enabled)switch(e.preventDefault(),A){case x.TOUCH_ROTATE:if(!1===R.enableRotate)return;ne(e),R.update();break;case x.TOUCH_PAN:if(!1===R.enablePan)return;re(e),R.update();break;case x.TOUCH_DOLLY_PAN:if(!1===R.enableZoom&&!1===R.enablePan)return;!function(e){R.enableZoom&&ae(e),R.enablePan&&re(e)}(e),R.update();break;case x.TOUCH_DOLLY_ROTATE:if(!1===R.enableZoom&&!1===R.enableRotate)return;!function(e){R.enableZoom&&ae(e),R.enableRotate&&ne(e)}(e),R.update();break;default:A=x.NONE}}function he(e){!1!==R.enabled&&(R.dispatchEvent(y),A=x.NONE)}function pe(e){!1!==R.enabled&&e.preventDefault()}return R.domElement.addEventListener("contextmenu",pe),R.domElement.addEventListener("pointerdown",se),R.domElement.addEventListener("wheel",ue,{passive:!1}),R.domElement.addEventListener("touchstart",le,{passive:!1}),R.domElement.addEventListener("touchend",he),R.domElement.addEventListener("touchmove",de,{passive:!1}),c.update(),c}return n}(h.n)},262:function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));n(72);var r=n(31),o=n(140),c=n(22);function l(e,t,n){return l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=Object(c.a)(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}},l(e,t,n||e)}var d=n(16),h=n(17),f=n(41),m=n(40),v=(n(139),n(269),n(14),n(272),n(274),n(275),n(276),n(277),n(278),n(279),n(280),n(281),n(282),n(283),n(284),n(285),n(286),n(287),n(289),n(290),n(291),n(292),n(293),n(294),n(299),n(300),n(301),n(24),n(30),n(34),n(321),n(53),n(322),n(50),n(201),n(136),n(64),n(79),n(44),n(302),n(303),n(304),n(305),n(306),n(307),n(54),n(323),n(326),n(327),n(328),n(329),n(330),n(331),n(333),n(334),n(335),n(336),n(337),n(338),n(339),n(340),n(196),n(36),n(0));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var o=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(m.a)(this,n)}}var T=function(e){Object(f.a)(n,e);var t=y(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).dracoLoader=null,r.ktx2Loader=null,r.meshoptDecoder=null,r.pluginCallbacks=[],r.register((function(e){return new A(e)})),r.register((function(e){return new O(e)})),r.register((function(e){return new M(e)})),r.register((function(e){return new _(e)})),r.register((function(e){return new R(e)})),r.register((function(e){return new L(e)})),r}return Object(h.a)(n,[{key:"load",value:function(e,t,n,r){var o,c=this;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:v.I.extractUrlBase(e),this.manager.itemStart(e);var l=function(t){r?r(t):console.error(t),c.manager.itemError(e),c.manager.itemEnd(e)},d=new v.o(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(e,(function(data){try{c.parse(data,o,(function(n){t(n),c.manager.itemEnd(e)}),l)}catch(e){l(e)}}),n,l)}},{key:"setDRACOLoader",value:function(e){return this.dracoLoader=e,this}},{key:"setDDSLoader",value:function(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}},{key:"setKTX2Loader",value:function(e){return this.ktx2Loader=e,this}},{key:"setMeshoptDecoder",value:function(e){return this.meshoptDecoder=e,this}},{key:"register",value:function(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}},{key:"unregister",value:function(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}},{key:"parse",value:function(data,path,e,t){var content,n={},r={};if("string"==typeof data)content=data;else if(v.I.decodeText(new Uint8Array(data,0,4))===k){try{n[w.KHR_BINARY_GLTF]=new I(data)}catch(e){return void(t&&t(e))}content=n[w.KHR_BINARY_GLTF].content}else content=v.I.decodeText(new Uint8Array(data));var o=JSON.parse(content);if(void 0===o.asset||o.asset.version[0]<2)t&&t(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{var c=new le(o,{path:path||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(var i=0;i<this.pluginCallbacks.length;i++){var l=this.pluginCallbacks[i](c);r[l.name]=l,n[l.name]=!0}if(o.extensionsUsed)for(var d=0;d<o.extensionsUsed.length;++d){var h=o.extensionsUsed[d],f=o.extensionsRequired||[];switch(h){case w.KHR_MATERIALS_UNLIT:n[h]=new x;break;case w.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:n[h]=new D;break;case w.KHR_DRACO_MESH_COMPRESSION:n[h]=new N(o,this.dracoLoader);break;case w.KHR_TEXTURE_TRANSFORM:n[h]=new j;break;case w.KHR_MESH_QUANTIZATION:n[h]=new U;break;default:f.indexOf(h)>=0&&void 0===r[h]&&console.warn('THREE.GLTFLoader: Unknown extension "'+h+'".')}}c.setExtensions(n),c.setPlugins(r),c.parse(e,t)}}}]),n}(v.H);function E(){var e={};return{get:function(t){return e[t]},add:function(t,object){e[t]=object},remove:function(t){delete e[t]},removeAll:function(){e={}}}}var w={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"},R=function(){function e(t){Object(d.a)(this,e),this.parser=t,this.name=w.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}return Object(h.a)(e,[{key:"_markDefs",value:function(){for(var e=this.parser,t=this.parser.json.nodes||[],n=0,r=t.length;n<r;n++){var o=t[n];o.extensions&&o.extensions[this.name]&&void 0!==o.extensions[this.name].light&&e._addNodeRef(this.cache,o.extensions[this.name].light)}}},{key:"_loadLight",value:function(e){var t=this.parser,n="light:"+e,r=t.cache.get(n);if(r)return r;var o,c=t.json,l=((c.extensions&&c.extensions[this.name]||{}).lights||[])[e],d=new v.k(16777215);void 0!==l.color&&d.fromArray(l.color);var h=void 0!==l.range?l.range:0;switch(l.type){case"directional":(o=new v.l(d)).target.position.set(0,0,-1),o.add(o.target);break;case"point":(o=new v.Z(d)).distance=h;break;case"spot":(o=new v.ob(d)).distance=h,l.spot=l.spot||{},l.spot.innerConeAngle=void 0!==l.spot.innerConeAngle?l.spot.innerConeAngle:0,l.spot.outerConeAngle=void 0!==l.spot.outerConeAngle?l.spot.outerConeAngle:Math.PI/4,o.angle=l.spot.outerConeAngle,o.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,o.target.position.set(0,0,-1),o.add(o.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return o.position.set(0,0,0),o.decay=2,void 0!==l.intensity&&(o.intensity=l.intensity),o.name=t.createUniqueName(l.name||"light_"+e),r=Promise.resolve(o),t.cache.add(n,r),r}},{key:"createNodeAttachment",value:function(e){var t=this,n=this.parser,r=n.json.nodes[e],o=(r.extensions&&r.extensions[this.name]||{}).light;return void 0===o?null:this._loadLight(o).then((function(e){return n._getNodeRef(t.cache,o,e)}))}}]),e}(),x=function(){function e(){Object(d.a)(this,e),this.name=w.KHR_MATERIALS_UNLIT}return Object(h.a)(e,[{key:"getMaterialType",value:function(){return v.O}},{key:"extendParams",value:function(e,t,n){var r=[];e.color=new v.k(1,1,1),e.opacity=1;var o=t.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){var c=o.baseColorFactor;e.color.fromArray(c),e.opacity=c[3]}void 0!==o.baseColorTexture&&r.push(n.assignTexture(e,"map",o.baseColorTexture))}return Promise.all(r)}}]),e}(),A=function(){function e(t){Object(d.a)(this,e),this.parser=t,this.name=w.KHR_MATERIALS_CLEARCOAT}return Object(h.a)(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?v.P:null}},{key:"extendMaterialParams",value:function(e,t){var n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var o=[],c=r.extensions[this.name];if(void 0!==c.clearcoatFactor&&(t.clearcoat=c.clearcoatFactor),void 0!==c.clearcoatTexture&&o.push(n.assignTexture(t,"clearcoatMap",c.clearcoatTexture)),void 0!==c.clearcoatRoughnessFactor&&(t.clearcoatRoughness=c.clearcoatRoughnessFactor),void 0!==c.clearcoatRoughnessTexture&&o.push(n.assignTexture(t,"clearcoatRoughnessMap",c.clearcoatRoughnessTexture)),void 0!==c.clearcoatNormalTexture&&(o.push(n.assignTexture(t,"clearcoatNormalMap",c.clearcoatNormalTexture)),void 0!==c.clearcoatNormalTexture.scale)){var l=c.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new v.vb(l,-l)}return Promise.all(o)}}]),e}(),_=function(){function e(t){Object(d.a)(this,e),this.parser=t,this.name=w.KHR_MATERIALS_TRANSMISSION}return Object(h.a)(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?v.P:null}},{key:"extendMaterialParams",value:function(e,t){var n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var o=[],c=r.extensions[this.name];return void 0!==c.transmissionFactor&&(t.transmission=c.transmissionFactor),void 0!==c.transmissionTexture&&o.push(n.assignTexture(t,"transmissionMap",c.transmissionTexture)),Promise.all(o)}}]),e}(),O=function(){function e(t){Object(d.a)(this,e),this.parser=t,this.name=w.KHR_TEXTURE_BASISU}return Object(h.a)(e,[{key:"loadTexture",value:function(e){var t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;var o=r.extensions[this.name],source=n.images[o.source],c=t.options.ktx2Loader;if(!c){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,source,c)}}]),e}(),M=function(){function e(t){Object(d.a)(this,e),this.parser=t,this.name=w.EXT_TEXTURE_WEBP,this.isSupported=null}return Object(h.a)(e,[{key:"loadTexture",value:function(e){var t=this.name,n=this.parser,r=n.json,o=r.textures[e];if(!o.extensions||!o.extensions[t])return null;var c=o.extensions[t],source=r.images[c.source],l=n.textureLoader;if(source.uri){var d=n.options.manager.getHandler(source.uri);null!==d&&(l=d)}return this.detectSupport().then((function(o){if(o)return n.loadTextureImage(e,source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)}))}},{key:"detectSupport",value:function(){return this.isSupported||(this.isSupported=new Promise((function(e){var image=new Image;image.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",image.onload=image.onerror=function(){e(1===image.height)}}))),this.isSupported}}]),e}(),L=function(){function e(t){Object(d.a)(this,e),this.name=w.EXT_MESHOPT_COMPRESSION,this.parser=t}return Object(h.a)(e,[{key:"loadBufferView",value:function(e){var t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){var r=n.extensions[this.name],o=this.parser.getDependency("buffer",r.buffer),c=this.parser.options.meshoptDecoder;if(!c||!c.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([o,c.ready]).then((function(e){var t=r.byteOffset||0,n=r.byteLength||0,o=r.count,l=r.byteStride,d=new ArrayBuffer(o*l),source=new Uint8Array(e[0],t,n);return c.decodeGltfBuffer(new Uint8Array(d),o,l,source,r.mode,r.filter),d}))}return null}}]),e}(),k="glTF",S=1313821514,P=5130562,I=function e(data){Object(d.a)(this,e),this.name=w.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(data,0,12);if(this.header={magic:v.I.decodeText(new Uint8Array(data.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==k)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var n=this.header.length-12,r=new DataView(data,12),o=0;o<n;){var c=r.getUint32(o,!0);o+=4;var l=r.getUint32(o,!0);if(o+=4,l===S){var h=new Uint8Array(data,12+o,c);this.content=v.I.decodeText(h)}else if(l===P){var f=12+o;this.body=data.slice(f,f+c)}o+=c}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")},N=function(){function e(t,n){if(Object(d.a)(this,e),!n)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=w.KHR_DRACO_MESH_COMPRESSION,this.json=t,this.dracoLoader=n,this.dracoLoader.preload()}return Object(h.a)(e,[{key:"decodePrimitive",value:function(e,t){var n=this.json,r=this.dracoLoader,o=e.extensions[this.name].bufferView,c=e.extensions[this.name].attributes,l={},d={},h={};for(var f in c){var m=Q[f]||f.toLowerCase();l[m]=c[f]}for(var v in e.attributes){var y=Q[v]||v.toLowerCase();if(void 0!==c[v]){var T=n.accessors[e.attributes[v]],E=z[T.componentType];h[y]=E,d[y]=!0===T.normalized}}return t.getDependency("bufferView",o).then((function(e){return new Promise((function(t){r.decodeDracoFile(e,(function(e){for(var n in e.attributes){var r=e.attributes[n],o=d[n];void 0!==o&&(r.normalized=o)}t(e)}),l,h)}))}))}}]),e}(),j=function(){function e(){Object(d.a)(this,e),this.name=w.KHR_TEXTURE_TRANSFORM}return Object(h.a)(e,[{key:"extendTexture",value:function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e}}]),e}(),C=function(e){Object(f.a)(n,e);var t=y(n);function n(e){var r;Object(d.a)(this,n),(r=t.call(this)).isGLTFSpecularGlossinessMaterial=!0;var c=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),l=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),h=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),f=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),m=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),y={specular:{value:(new v.k).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};return r._extraUniforms=y,r.onBeforeCompile=function(e){for(var t in y)e.uniforms[t]=y[t];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",c).replace("#include <metalnessmap_pars_fragment>",l).replace("#include <roughnessmap_fragment>",h).replace("#include <metalnessmap_fragment>",f).replace("#include <lights_physical_fragment>",m)},Object.defineProperties(Object(o.a)(r),{specular:{get:function(){return y.specular.value},set:function(e){y.specular.value=e}},specularMap:{get:function(){return y.specularMap.value},set:function(e){y.specularMap.value=e,e?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return y.glossiness.value},set:function(e){y.glossiness.value=e}},glossinessMap:{get:function(){return y.glossinessMap.value},set:function(e){y.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete r.metalness,delete r.roughness,delete r.metalnessMap,delete r.roughnessMap,r.setValues(e),r}return Object(h.a)(n,[{key:"copy",value:function(source){return l(Object(c.a)(n.prototype),"copy",this).call(this,source),this.specularMap=source.specularMap,this.specular.copy(source.specular),this.glossinessMap=source.glossinessMap,this.glossiness=source.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}]),n}(v.Q),D=function(){function e(){Object(d.a)(this,e),this.name=w.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"]}return Object(h.a)(e,[{key:"getMaterialType",value:function(){return C}},{key:"extendParams",value:function(e,t,n){var r=t.extensions[this.name];e.color=new v.k(1,1,1),e.opacity=1;var o=[];if(Array.isArray(r.diffuseFactor)){var c=r.diffuseFactor;e.color.fromArray(c),e.opacity=c[3]}if(void 0!==r.diffuseTexture&&o.push(n.assignTexture(e,"map",r.diffuseTexture)),e.emissive=new v.k(0,0,0),e.glossiness=void 0!==r.glossinessFactor?r.glossinessFactor:1,e.specular=new v.k(1,1,1),Array.isArray(r.specularFactor)&&e.specular.fromArray(r.specularFactor),void 0!==r.specularGlossinessTexture){var l=r.specularGlossinessTexture;o.push(n.assignTexture(e,"glossinessMap",l)),o.push(n.assignTexture(e,"specularMap",l))}return Promise.all(o)}},{key:"createMaterial",value:function(e){var t=new C(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=v.qb,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}]),e}(),U=function e(){Object(d.a)(this,e),this.name=w.KHR_MESH_QUANTIZATION},H=function(e){Object(f.a)(n,e);var t=y(n);function n(e,r,o,c){return Object(d.a)(this,n),t.call(this,e,r,o,c)}return Object(h.a)(n,[{key:"copySampleValue_",value:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,o=e*r*3+r,i=0;i!==r;i++)t[i]=n[o+i];return t}}]),n}(v.x);H.prototype.beforeStart_=H.prototype.copySampleValue_,H.prototype.afterEnd_=H.prototype.copySampleValue_,H.prototype.interpolate_=function(e,t,n,r){for(var o=this.resultBuffer,c=this.sampleValues,l=this.valueSize,d=2*l,h=3*l,td=r-t,p=(n-t)/td,f=p*p,m=f*p,v=e*h,y=v-h,T=-2*m+3*f,E=m-f,w=1-T,R=E-f+p,i=0;i!==l;i++){var x=c[y+i+l],A=c[y+i+d]*td,_=c[v+i+l],O=c[v+i]*td;o[i]=w*x+R*A+T*_+E*O}return o};var F=0,G=1,B=2,K=3,X=4,V=5,Y=6,z={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},W={9728:v.S,9729:v.E,9984:v.U,9985:v.G,9986:v.T,9987:v.F},Z={33071:v.i,33648:v.R,10497:v.hb},J={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Q={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},$={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},ee={CUBICSPLINE:void 0,LINEAR:v.z,STEP:v.y},te="OPAQUE",ne="MASK",re="BLEND";function ae(e,path){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(path)&&/^\//.test(e)&&(path=path.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:path+e)}function se(e,object,t){for(var n in t.extensions)void 0===e[n]&&(object.userData.gltfExtensions=object.userData.gltfExtensions||{},object.userData.gltfExtensions[n]=t.extensions[n])}function oe(object,e){void 0!==e.extras&&("object"===Object(r.a)(e.extras)?Object.assign(object.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function ie(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var i=0,n=t.weights.length;i<n;i++)e.morphTargetInfluences[i]=t.weights[i];if(t.extras&&Array.isArray(t.extras.targetNames)){var r=t.extras.targetNames;if(e.morphTargetInfluences.length===r.length){e.morphTargetDictionary={};for(var o=0,c=r.length;o<c;o++)e.morphTargetDictionary[r[o]]=o}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function ue(e){for(var t="",n=Object.keys(e).sort(),i=0,r=n.length;i<r;i++)t+=n[i]+":"+e[n[i]]+";";return t}function ce(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}var le=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(d.a)(this,e),this.json=t,this.extensions={},this.plugins={},this.options=n,this.cache=new E,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.nodeNamesUsed={},"undefined"!=typeof createImageBitmap&&!1===/Firefox/.test(navigator.userAgent)?this.textureLoader=new v.u(this.options.manager):this.textureLoader=new v.rb(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new v.o(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}return Object(h.a)(e,[{key:"setExtensions",value:function(e){this.extensions=e}},{key:"setPlugins",value:function(e){this.plugins=e}},{key:"parse",value:function(e,t){var n=this,r=this.json,o=this.extensions;this.cache.removeAll(),this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])})).then((function(t){var c={scene:t[0][r.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:r.asset,parser:n,userData:{}};se(o,c,r),oe(c,r),Promise.all(n._invokeAll((function(e){return e.afterRoot&&e.afterRoot(c)}))).then((function(){e(c)}))})).catch(t)}},{key:"_markDefs",value:function(){for(var e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[],r=0,o=t.length;r<o;r++)for(var c=t[r].joints,i=0,l=c.length;i<l;i++)e[c[i]].isBone=!0;for(var d=0,h=e.length;d<h;d++){var f=e[d];void 0!==f.mesh&&(this._addNodeRef(this.meshCache,f.mesh),void 0!==f.skin&&(n[f.mesh].isSkinnedMesh=!0)),void 0!==f.camera&&this._addNodeRef(this.cameraCache,f.camera)}}},{key:"_addNodeRef",value:function(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}},{key:"_getNodeRef",value:function(e,t,object){if(e.refs[t]<=1)return object;var n=object.clone();return n.name+="_instance_"+e.uses[t]++,n}},{key:"_invokeOne",value:function(e){var t=Object.values(this.plugins);t.push(this);for(var i=0;i<t.length;i++){var n=e(t[i]);if(n)return n}return null}},{key:"_invokeAll",value:function(e){var t=Object.values(this.plugins);t.unshift(this);for(var n=[],i=0;i<t.length;i++){var r=e(t[i]);r&&n.push(r)}return n}},{key:"getDependency",value:function(e,t){var n=e+":"+t,r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this.loadNode(t);break;case"mesh":r=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":r=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":r=this.loadSkin(t);break;case"animation":r=this.loadAnimation(t);break;case"camera":r=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r}},{key:"getDependencies",value:function(e){var t=this.cache.get(e);if(!t){var n=this,defs=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(defs.map((function(t,r){return n.getDependency(e,r)}))),this.cache.add(e,t)}return t}},{key:"loadBuffer",value:function(e){var t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[w.KHR_BINARY_GLTF].body);var r=this.options;return new Promise((function(e,o){n.load(ae(t.uri,r.path),e,void 0,(function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))}},{key:"loadBufferView",value:function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){var n=t.byteLength||0,r=t.byteOffset||0;return e.slice(r,r+n)}))}},{key:"loadAccessor",value:function(e){var t=this,n=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse)return Promise.resolve(null);var o=[];return void 0!==r.bufferView?o.push(this.getDependency("bufferView",r.bufferView)):o.push(null),void 0!==r.sparse&&(o.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(o).then((function(e){var o,c,l=e[0],d=J[r.type],h=z[r.componentType],f=h.BYTES_PER_ELEMENT,m=f*d,y=r.byteOffset||0,T=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,E=!0===r.normalized;if(T&&T!==m){var w=Math.floor(y/T),R="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+w+":"+r.count,x=t.cache.get(R);x||(o=new h(l,w*T,r.count*T/f),x=new v.v(o,T/f),t.cache.add(R,x)),c=new v.w(x,d,y%T/f,E)}else o=null===l?new h(r.count*d):new h(l,y,r.count*d),c=new v.f(o,d,E);if(void 0!==r.sparse){var A=J.SCALAR,_=z[r.sparse.indices.componentType],O=r.sparse.indices.byteOffset||0,M=r.sparse.values.byteOffset||0,L=new _(e[1],O,r.sparse.count*A),k=new h(e[2],M,r.sparse.count*d);null!==l&&(c=new v.f(c.array.slice(),c.itemSize,c.normalized));for(var i=0,S=L.length;i<S;i++){var P=L[i];if(c.setX(P,k[i*d]),d>=2&&c.setY(P,k[i*d+1]),d>=3&&c.setZ(P,k[i*d+2]),d>=4&&c.setW(P,k[i*d+3]),d>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return c}))}},{key:"loadTexture",value:function(e){var t=this.json,n=this.options,r=t.textures[e],source=t.images[r.source],o=this.textureLoader;if(source.uri){var c=n.manager.getHandler(source.uri);null!==c&&(o=c)}return this.loadTextureImage(e,source,o)}},{key:"loadTextureImage",value:function(e,source,t){var n=this,r=this.json,o=this.options,c=r.textures[e],l=self.URL||self.webkitURL,d=source.uri,h=!1,f=!0;if("image/jpeg"===source.mimeType&&(f=!1),void 0!==source.bufferView)d=n.getDependency("bufferView",source.bufferView).then((function(e){if("image/png"===source.mimeType){var t=new DataView(e,25,1).getUint8(0,!1);f=6===t||4===t||3===t}h=!0;var n=new Blob([e],{type:source.mimeType});return d=l.createObjectURL(n)}));else if(void 0===source.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");return Promise.resolve(d).then((function(e){return new Promise((function(n,r){var c=n;!0===t.isImageBitmapLoader&&(c=function(e){n(new v.h(e))}),t.load(ae(e,o.path),c,void 0,r)}))})).then((function(t){!0===h&&l.revokeObjectURL(d),t.flipY=!1,c.name&&(t.name=c.name),f||(t.format=v.gb);var o=(r.samplers||{})[c.sampler]||{};return t.magFilter=W[o.magFilter]||v.E,t.minFilter=W[o.minFilter]||v.F,t.wrapS=Z[o.wrapS]||v.hb,t.wrapT=Z[o.wrapT]||v.hb,n.associations.set(t,{type:"textures",index:e}),t}))}},{key:"assignTexture",value:function(e,t,n){var r=this;return this.getDependency("texture",n.index).then((function(o){if(void 0===n.texCoord||0==n.texCoord||"aoMap"===t&&1==n.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),r.extensions[w.KHR_TEXTURE_TRANSFORM]){var c=void 0!==n.extensions?n.extensions[w.KHR_TEXTURE_TRANSFORM]:void 0;if(c){var l=r.associations.get(o);o=r.extensions[w.KHR_TEXTURE_TRANSFORM].extendTexture(o,c),r.associations.set(o,l)}}e[t]=o}))}},{key:"assignFinalMaterial",value:function(e){var t=e.geometry,n=e.material,r=void 0!==t.attributes.tangent,o=void 0!==t.attributes.color,c=void 0===t.attributes.normal,l=!0===e.isSkinnedMesh,d=Object.keys(t.morphAttributes).length>0,h=d&&void 0!==t.morphAttributes.normal;if(e.isPoints){var f="PointsMaterial:"+n.uuid,m=this.cache.get(f);m||(m=new v.bb,v.K.prototype.copy.call(m,n),m.color.copy(n.color),m.map=n.map,m.sizeAttenuation=!1,this.cache.add(f,m)),n=m}else if(e.isLine){var y="LineBasicMaterial:"+n.uuid,T=this.cache.get(y);T||(T=new v.B,v.K.prototype.copy.call(T,n),T.color.copy(n.color),this.cache.add(y,T)),n=T}if(r||o||c||l||d){var E="ClonedMaterial:"+n.uuid+":";n.isGLTFSpecularGlossinessMaterial&&(E+="specular-glossiness:"),l&&(E+="skinning:"),r&&(E+="vertex-tangents:"),o&&(E+="vertex-colors:"),c&&(E+="flat-shading:"),d&&(E+="morph-targets:"),h&&(E+="morph-normals:");var w=this.cache.get(E);w||(w=n.clone(),l&&(w.skinning=!0),o&&(w.vertexColors=!0),c&&(w.flatShading=!0),d&&(w.morphTargets=!0),h&&(w.morphNormals=!0),r&&(w.vertexTangents=!0,w.normalScale&&(w.normalScale.y*=-1),w.clearcoatNormalScale&&(w.clearcoatNormalScale.y*=-1)),this.cache.add(E,w),this.associations.set(w,this.associations.get(n))),n=w}n.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=n}},{key:"getMaterialType",value:function(){return v.Q}},{key:"loadMaterial",value:function(e){var t,n=this,r=this.json,o=this.extensions,c=r.materials[e],l={},d=c.extensions||{},h=[];if(d[w.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var f=o[w.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=f.getMaterialType(),h.push(f.extendParams(l,c,n))}else if(d[w.KHR_MATERIALS_UNLIT]){var m=o[w.KHR_MATERIALS_UNLIT];t=m.getMaterialType(),h.push(m.extendParams(l,c,n))}else{var y=c.pbrMetallicRoughness||{};if(l.color=new v.k(1,1,1),l.opacity=1,Array.isArray(y.baseColorFactor)){var T=y.baseColorFactor;l.color.fromArray(T),l.opacity=T[3]}void 0!==y.baseColorTexture&&h.push(n.assignTexture(l,"map",y.baseColorTexture)),l.metalness=void 0!==y.metallicFactor?y.metallicFactor:1,l.roughness=void 0!==y.roughnessFactor?y.roughnessFactor:1,void 0!==y.metallicRoughnessTexture&&(h.push(n.assignTexture(l,"metalnessMap",y.metallicRoughnessTexture)),h.push(n.assignTexture(l,"roughnessMap",y.metallicRoughnessTexture))),t=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)})),h.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,l)}))))}!0===c.doubleSided&&(l.side=v.m);var E=c.alphaMode||te;return E===re?(l.transparent=!0,l.depthWrite=!1):(l.transparent=!1,E===ne&&(l.alphaTest=void 0!==c.alphaCutoff?c.alphaCutoff:.5)),void 0!==c.normalTexture&&t!==v.O&&(h.push(n.assignTexture(l,"normalMap",c.normalTexture)),l.normalScale=new v.vb(1,-1),void 0!==c.normalTexture.scale&&l.normalScale.set(c.normalTexture.scale,-c.normalTexture.scale)),void 0!==c.occlusionTexture&&t!==v.O&&(h.push(n.assignTexture(l,"aoMap",c.occlusionTexture)),void 0!==c.occlusionTexture.strength&&(l.aoMapIntensity=c.occlusionTexture.strength)),void 0!==c.emissiveFactor&&t!==v.O&&(l.emissive=(new v.k).fromArray(c.emissiveFactor)),void 0!==c.emissiveTexture&&t!==v.O&&h.push(n.assignTexture(l,"emissiveMap",c.emissiveTexture)),Promise.all(h).then((function(){var r;return r=t===C?o[w.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(l):new t(l),c.name&&(r.name=c.name),r.map&&(r.map.encoding=v.Bb),r.emissiveMap&&(r.emissiveMap.encoding=v.Bb),oe(r,c),n.associations.set(r,{type:"materials",index:e}),c.extensions&&se(o,r,c),r}))}},{key:"createUniqueName",value:function(e){for(var t=v.cb.sanitizeNodeName(e||""),n=t,i=1;this.nodeNamesUsed[n];++i)n=t+"_"+i;return this.nodeNamesUsed[n]=!0,n}},{key:"loadGeometries",value:function(e){var t=this,n=this.extensions,r=this.primitiveCache;function o(e){return n[w.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(n){return he(n,e,t)}))}for(var c,l,d=[],i=0,h=e.length;i<h;i++){var f=e[i],m=(l=void 0,(l=(c=f).extensions&&c.extensions[w.KHR_DRACO_MESH_COMPRESSION])?"draco:"+l.bufferView+":"+l.indices+":"+ue(l.attributes):c.indices+":"+ue(c.attributes)+":"+c.mode),y=r[m];if(y)d.push(y.promise);else{var T=void 0;T=f.extensions&&f.extensions[w.KHR_DRACO_MESH_COMPRESSION]?o(f):he(new v.g,f,t),r[m]={primitive:f,promise:T},d.push(T)}}return Promise.all(d)}},{key:"loadMesh",value:function(e){for(var t,n=this,r=this.json,o=this.extensions,c=r.meshes[e],l=c.primitives,d=[],i=0,h=l.length;i<h;i++){var f=void 0===l[i].material?(void 0===(t=this.cache).DefaultMaterial&&(t.DefaultMaterial=new v.Q({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:v.r})),t.DefaultMaterial):this.getDependency("material",l[i].material);d.push(f)}return d.push(n.loadGeometries(l)),Promise.all(d).then((function(t){for(var r=t.slice(0,t.length-1),d=t[t.length-1],h=[],f=0,m=d.length;f<m;f++){var y=d[f],T=l[f],E=void 0,w=r[f];if(T.mode===X||T.mode===V||T.mode===Y||void 0===T.mode)!0!==(E=!0===c.isSkinnedMesh?new v.lb(y,w):new v.N(y,w)).isSkinnedMesh||E.geometry.attributes.skinWeight.normalized||E.normalizeSkinWeights(),T.mode===V?E.geometry=pe(E.geometry,v.tb):T.mode===Y&&(E.geometry=pe(E.geometry,v.sb));else if(T.mode===G)E=new v.D(y,w);else if(T.mode===K)E=new v.A(y,w);else if(T.mode===B)E=new v.C(y,w);else{if(T.mode!==F)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+T.mode);E=new v.ab(y,w)}Object.keys(E.geometry.morphAttributes).length>0&&ie(E,c),E.name=n.createUniqueName(c.name||"mesh_"+e),oe(E,c),T.extensions&&se(o,E,T),n.assignFinalMaterial(E),h.push(E)}if(1===h.length)return h[0];for(var R=new v.t,x=0,A=h.length;x<A;x++)R.add(h[x]);return R}))}},{key:"loadCamera",value:function(e){var t,n=this.json.cameras[e],r=n[n.type];if(r)return"perspective"===n.type?t=new v.Y(v.L.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(t=new v.X(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),oe(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}},{key:"loadSkin",value:function(e){var t=this.json.skins[e],n={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return n.inverseBindMatrices=e,n}))}},{key:"loadAnimation",value:function(e){for(var t=this.json.animations[e],n=[],r=[],o=[],c=[],l=[],i=0,d=t.channels.length;i<d;i++){var h=t.channels[i],f=t.samplers[h.sampler],m=h.target,y=void 0!==m.node?m.node:m.id,input=void 0!==t.parameters?t.parameters[f.input]:f.input,output=void 0!==t.parameters?t.parameters[f.output]:f.output;n.push(this.getDependency("node",y)),r.push(this.getDependency("accessor",input)),o.push(this.getDependency("accessor",output)),c.push(f),l.push(m)}return Promise.all([Promise.all(n),Promise.all(r),Promise.all(o),Promise.all(c),Promise.all(l)]).then((function(n){for(var r=n[0],o=n[1],c=n[2],l=n[3],d=n[4],h=[],f=function(e,t){var n=r[e],f=o[e],m=c[e],y=l[e],T=d[e];if(void 0===n)return"continue";n.updateMatrix(),n.matrixAutoUpdate=!0;var E=void 0;switch($[T.path]){case $.weights:E=v.V;break;case $.rotation:E=v.eb;break;default:E=v.xb}var w=n.name?n.name:n.uuid,R=void 0!==y.interpolation?ee[y.interpolation]:v.z,x=[];$[T.path]===$.weights?n.traverse((function(object){!0===object.isMesh&&object.morphTargetInfluences&&x.push(object.name?object.name:object.uuid)})):x.push(w);var A=m.array;if(m.normalized){for(var _=ce(A.constructor),O=new Float32Array(A.length),M=0,L=A.length;M<L;M++)O[M]=A[M]*_;A=O}for(var k=0,S=x.length;k<S;k++){var track=new E(x[k]+"."+$[T.path],f.array,A,R);"CUBICSPLINE"===y.interpolation&&(track.createInterpolant=function(e){return new H(this.times,this.values,this.getValueSize()/3,e)},track.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),h.push(track)}},m=0,y=r.length;m<y;m++)f(m);var T=t.name?t.name:"animation_"+e;return new v.c(T,void 0,h)}))}},{key:"createNodeMesh",value:function(e){var t=this.json,n=this,r=t.nodes[e];return void 0===r.mesh?null:n.getDependency("mesh",r.mesh).then((function(e){var t=n._getNodeRef(n.meshCache,r.mesh,e);return void 0!==r.weights&&t.traverse((function(e){if(e.isMesh)for(var i=0,t=r.weights.length;i<t;i++)e.morphTargetInfluences[i]=r.weights[i]})),t}))}},{key:"loadNode",value:function(e){var t,n,r=this.json,o=this.extensions,c=this,l=r.nodes[e],d=l.name?c.createUniqueName(l.name):"";return(t=[],n=c._invokeOne((function(t){return t.createNodeMesh&&t.createNodeMesh(e)})),n&&t.push(n),void 0!==l.camera&&t.push(c.getDependency("camera",l.camera).then((function(e){return c._getNodeRef(c.cameraCache,l.camera,e)}))),c._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){t.push(e)})),Promise.all(t)).then((function(t){var n;if((n=!0===l.isBone?new v.d:t.length>1?new v.t:1===t.length?t[0]:new v.W)!==t[0])for(var i=0,r=t.length;i<r;i++)n.add(t[i]);if(l.name&&(n.userData.name=l.name,n.name=d),oe(n,l),l.extensions&&se(o,n,l),void 0!==l.matrix){var h=new v.M;h.fromArray(l.matrix),n.applyMatrix4(h)}else void 0!==l.translation&&n.position.fromArray(l.translation),void 0!==l.rotation&&n.quaternion.fromArray(l.rotation),void 0!==l.scale&&n.scale.fromArray(l.scale);return c.associations.set(n,{type:"nodes",index:e}),n}))}},{key:"loadScene",value:function(e){var t=this.json,n=this.extensions,r=this.json.scenes[e],o=new v.t;r.name&&(o.name=this.createUniqueName(r.name)),oe(o,r),r.extensions&&se(n,o,r);for(var c=r.nodes||[],l=[],i=0,d=c.length;i<d;i++)l.push(de(c[i],o,t,this));return Promise.all(l).then((function(){return o}))}}]),e}();function de(e,t,n,r){var o=n.nodes[e];return r.getDependency("node",e).then((function(e){return void 0===o.skin?e:r.getDependency("skin",o.skin).then((function(e){for(var n=[],i=0,o=(t=e).joints.length;i<o;i++)n.push(r.getDependency("node",t.joints[i]));return Promise.all(n)})).then((function(n){return e.traverse((function(e){if(e.isMesh){for(var r=[],o=[],c=0,l=n.length;c<l;c++){var d=n[c];if(d){r.push(d);var h=new v.M;void 0!==t.inverseBindMatrices&&h.fromArray(t.inverseBindMatrices.array,16*c),o.push(h)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}e.bind(new v.kb(r,o),e.matrixWorld)}})),e}));var t})).then((function(e){t.add(e);var c=[];if(o.children)for(var l=o.children,i=0,d=l.length;i<d;i++){var h=l[i];c.push(de(h,e,n,r))}return Promise.all(c)}))}function he(e,t,n){var r=t.attributes,o=[];function c(t,r){return n.getDependency("accessor",t).then((function(t){e.setAttribute(r,t)}))}for(var l in r){var d=Q[l]||l.toLowerCase();d in e.attributes||o.push(c(r[l],d))}if(void 0!==t.indices&&!e.index){var h=n.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));o.push(h)}return oe(e,t),function(e,t,n){var r=t.attributes,o=new v.e;if(void 0!==r.POSITION){var c=n.json.accessors[r.POSITION],l=c.min,d=c.max;if(void 0!==l&&void 0!==d){if(o.set(new v.wb(l[0],l[1],l[2]),new v.wb(d[0],d[1],d[2])),c.normalized){var h=ce(z[c.componentType]);o.min.multiplyScalar(h),o.max.multiplyScalar(h)}var f=t.targets;if(void 0!==f){for(var m=new v.wb,y=new v.wb,i=0,T=f.length;i<T;i++){var E=f[i];if(void 0!==E.POSITION){var w=n.json.accessors[E.POSITION],R=w.min,x=w.max;if(void 0!==R&&void 0!==x){if(y.setX(Math.max(Math.abs(R[0]),Math.abs(x[0]))),y.setY(Math.max(Math.abs(R[1]),Math.abs(x[1]))),y.setZ(Math.max(Math.abs(R[2]),Math.abs(x[2]))),w.normalized){var A=ce(z[w.componentType]);y.multiplyScalar(A)}m.max(y)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}o.expandByVector(m)}e.boundingBox=o;var _=new v.mb;o.getCenter(_.center),_.radius=o.min.distanceTo(o.max)/2,e.boundingSphere=_}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}(e,t,n),Promise.all(o).then((function(){return void 0!==t.targets?function(e,t,n){for(var r=!1,o=!1,i=0,c=t.length;i<c;i++){var l=t[i];if(void 0!==l.POSITION&&(r=!0),void 0!==l.NORMAL&&(o=!0),r&&o)break}if(!r&&!o)return Promise.resolve(e);for(var d=[],h=[],f=0,m=t.length;f<m;f++){var v=t[f];if(r){var y=void 0!==v.POSITION?n.getDependency("accessor",v.POSITION):e.attributes.position;d.push(y)}if(o){var T=void 0!==v.NORMAL?n.getDependency("accessor",v.NORMAL):e.attributes.normal;h.push(T)}}return Promise.all([Promise.all(d),Promise.all(h)]).then((function(t){var n=t[0],c=t[1];return r&&(e.morphAttributes.position=n),o&&(e.morphAttributes.normal=c),e.morphTargetsRelative=!0,e}))}(e,t.targets,n):e}))}function pe(e,t){var n=e.getIndex();if(null===n){var r=[],o=e.getAttribute("position");if(void 0===o)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(var i=0;i<o.count;i++)r.push(i);e.setIndex(r),n=e.getIndex()}var c=n.count-2,l=[];if(t===v.sb)for(var d=1;d<=c;d++)l.push(n.getX(0)),l.push(n.getX(d)),l.push(n.getX(d+1));else for(var h=0;h<c;h++)h%2==0?(l.push(n.getX(h)),l.push(n.getX(h+1)),l.push(n.getX(h+2))):(l.push(n.getX(h+2)),l.push(n.getX(h+1)),l.push(n.getX(h)));l.length/3!==c&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var f=e.clone();return f.setIndex(l),f}}}]);